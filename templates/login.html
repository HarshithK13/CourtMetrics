<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!-- React and Babel for JSX support -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <!-- Login Component using React -->
    <script type="text/babel">
        const Login = () => {
            const [username, setUsername] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [message, setMessage] = React.useState('');

            const handleLogin = async (event) => {
                event.preventDefault();
                setMessage('');

                const response = await fetch('/signin', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        username,
                        password
                    })
                });

                const data = await response.json();
                if (response.ok) {
                    setMessage("Login successful!");
                    localStorage.setItem('access_token', data.access_token);
                } else {
                    setMessage(data.message || "An error occurred");
                }
            };

            return (
                <div className="container">
                    <h2>Login</h2>
                    {message && <p>{message}</p>}
                    <form onSubmit={handleLogin}>
                        <label>Username:</label>
                        <input type="text" value={username} onChange={(e) => setUsername(e.target.value)} required />
                        <label>Password:</label>
                        <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} required />
                        <button type="submit">Login</button>
                    </form>
                    <button className="cancel-button" onClick={() => window.location.href = '/'}>Cancel</button>
                </div>
            );
        };

        ReactDOM.render(<Login />, document.getElementById('root'));
    </script>
</body>
</html>